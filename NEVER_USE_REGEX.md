# 🚫 絶対にstd::regexを使うな！

## ⚠️ 重要：このプロジェクトの鉄則

### 🔴 禁止事項
```cpp
// ❌ 絶対ダメ！
#include <regex>
std::regex pattern("...");
std::sregex_iterator
```

### 💀 なぜstd::regexを使ってはいけないか

1. **Claudeの悪い癖**
   - 学習データの影響で無意識にstd::regex使いがち
   - 「簡単そう」に見えて実は罠
   - 何度も同じ過ちを繰り返す

2. **技術的な問題**
   - ネスト構造の解析不可
   - コンテキスト理解なし
   - パフォーマンス問題
   - メンテナンス地獄

3. **過去の失敗**
   - Raw string literal連結エラー
   - JavaScript正規表現の構文エラー
   - C#メソッド検出の失敗

## ✅ 代わりに使うべきもの

### 1. **PEGTL（推奨）**
```cpp
#include <tao/pegtl.hpp>
// PEG文法で正確な構文解析
```

### 2. **単純な文字列処理**
```cpp
// find(), substr(), find_first_of()等
size_t pos = content.find("class");
```

### 3. **Tree-sitter（将来的に）**
```cpp
// 本格的なAST解析
```

## 🛡️ 防止策

### Claudeへの指示
1. **新しいアナライザー作成時**
   - 最初から「PEGTLで実装」と明記
   - std::regexは絶対禁止と強調

2. **コードレビュー時**
   - `#include <regex>`を見つけたら即却下
   - 正規表現パターンを見つけたら警告

3. **設計段階**
   - 文法定義から始める（Grammar First）
   - パターンマッチングではなく構文解析

## 📝 チェックリスト

新しい言語アナライザー実装時：
- [ ] PEGTL文法定義ファイル作成済み？
- [ ] std::regexを一切使っていない？
- [ ] 文字列処理は最小限？
- [ ] テストケースでネスト構造確認？

## 🎯 覚えておくこと

**「正規表現は麻薬」** - 一度使うと依存してしまう。
最初から使わないことが大事！

---
作成日: 2025-01-27
理由: Claudeが何度もstd::regexに戻ってしまう問題への対策